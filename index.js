var SeqEngine=new function(){function n(n){return n in v}function t(){}function r(){console.log("SeqEngine = ["),y.forEach(function(n){console.log(n)}),console.log("  runned: "+JSON.stringify(v)),console.log("].")}function i(n){for(var t=0;t<y.length;t++)if(y[t].runner===n)return y[t];return null}function e(n){for(var t=0;t<y.length;t++){var r=y[t];if(n in r.running)return r}return null}function u(n,r){var i=new t,e={runner:i,tasks:n,running:{},callback:r};return y.unshift(e),e}function o(n){if(n.tasks.length>0)return!1;var t=y.indexOf(n);return t>=0&&y.splice(t,1),"function"==typeof n.callback&&n.callback(n.argument),!0}function f(n,t,r){return t in n.running?Object.keys(n.running[t]).length>0?!1:(delete n.running[t],"function"==typeof r&&r(),!0):!1}function a(n,t,r,i){for(var e=n.running[t],u=0;u<r.length;u++)e[r[u]]=i}function s(n,t,r,i){if("function"==typeof i&&i(),r in n.running[t]){var e=n.running[t][r];return delete n.running[t][r],f(n,t,e),!0}return!1}function c(t){if(!o(t)){var r=t.tasks.shift();Array.isArray(r)||(r=[r]);for(var i=[],e=0;e<r.length;e++){var u=r[e];"string"==typeof u&&(n(u)||(i.push(u),t.running[u]={}))}return 0===i.length?void c(t):void k.start.call(t.runner,i)}}function g(n,t){var r=u(n,t);return c(r),r}function l(n,t,r){f(n,t,r)&&0===Object.keys(n.running).length&&c(n)}function h(n,t,r,i){s(n,t,r,i)&&0===Object.keys(n.running).length&&c(n)}this.startTasks=g,this.endTask=l,this.waitTask=a,this.notifyTask=h,this.getInfoByRunner=i,this.getInfoByRunningTask=e,this.log=r;var k=require("gulp"),v={};k.on("task_start",function(n){v[n.task]=!0});var y=[];t.prototype=k};function Ender(n){function t(n){return"function"==typeof n[n.length-1]?n.pop():null}var e,i,r,u=SeqEngine.getInfoByRunningTask(n);return null!=u?(e=function(t){SeqEngine.endTask(u,n,t)},i=function(){var i=Array.prototype.slice.call(arguments),r=t(i);return SeqEngine.waitTask(u,n,i,r),e},r=function(t,i){return SeqEngine.notifyTask(u,n,t,i),e}):(e=function(n){"function"==typeof n&&n()},i=function(){var n=Array.prototype.slice.call(arguments),i=t(n);return null!=i&&i(),e},r=function(n,t){return"function"==typeof t&&t(),e}),e.with=function(n){return function(){e(n)}},e.wait=i,e.notify=r,e.notifier=function(n,t){return function(){r(n,t)}},e}!function(){var n=require("gulp"),r={},t=n.emit;n.emit=function(o,a){return a.task in r?!0:t.apply(n,arguments)};var o=n.task;n.task=function(t,a,i){function e(n){"function"==typeof n&&n()}function u(n){var r=33+Math.floor(94*Math.random()),t=33+Math.floor(94*Math.random()),o=String.fromCharCode(r),a=String.fromCharCode(t);return n+"[8m"+o+a+"[0m[2D"}function f(t,a){r[t]=!0;var i=u(t),e=a.concat(i),f=function(n){SeqEngine.startTasks(e,n)};return o.call(n,t,void 0,f),i}function c(n,r,t){var o=f(n,r);return v(o,void 0,t)}function v(r,t,a){var i;return i=a?0===a.length?function(){var n=new Ender(r);a(),n()}:function(n){var t=new Ender(r);a(function(){e(n),t()})}:function(){new Ender(r)()},o.call(n,r,t,i)}!function(){return Array.isArray(a)&&1===a.length&&Array.isArray(a[0])?c(t,a[0],i):(i||"function"!=typeof a||(i=a,a=void 0),v(t,a,i))}()}}();