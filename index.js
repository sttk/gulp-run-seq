"use strict";var gulp=require("gulp"),grunseq=new function(){function n(){}function r(n){for(var r=0;r<g.length;r++)if(g[r].runner===n)return g[r];return null}function t(n){for(var r=0;r<g.length;r++){var t=g[r];if(t.runner.seq.indexOf(n)>=0)return t}return null}function u(n){return n in s}function e(n){for(var r=n.runner.seq,t=0;t<r.length;t++)s[r[t]]=!0}function i(n){var r=g.indexOf(n);r>=0&&g.splice(r,1)}function l(n){return 0===Object.keys(n).length}function o(){var r=Array.prototype.slice.call(arguments),t=null;r.length>0&&"function"==typeof r[r.length-1]&&(t=r.pop());var u=new n,e=r,i={runner:u,tasks:e,running:{},callback:t};g.push(i),a(i)}function a(n){if(0===n.tasks.length)return i(n),void(null!=n.callback&&n.callback());var r=n.tasks.shift();Array.isArray(r)||(r=[r]);for(var t=[],l=0;l<r.length;l++){var o=r[l];u(o)||(t.push(o),n.running[o]={})}return 0===t.length?void a(n):(e(n),gulp.start.apply(n.runner,t),void e(n))}function f(n,t){var u=function(u){var e=r(n);null!=e&&t in e.running&&l(e.running[t])&&(delete e.running[t],"function"==typeof u&&u(!0),l(e.running)&&a(e))};return u.wait=function(){var e=r(n);if(null!=e){var i=Array.prototype.slice.call(arguments),l=p;if(i.length>0&&"function"==typeof i[i.length-1]&&(l=i.pop()),t in e.running){for(var o=e.running[t],a=0;a<i.length;a++)o[i[a]]=l;return u}}},u.notify=function(e,i){var o=r(n);if(null!=o&&t in o.running){var f=p;return e in o.running[t]&&(f=o.running[t][e],delete o.running[t][e]),l(o.running[t])&&delete o.running[t],null!=i&&i(!0),l(o.running)&&(f(!0),a(o)),u}},u}function c(n){var r=t(n);return null!=r?new f(r.runner,n):v}this.start=o,this.ender=c;var g=[],s={};n.prototype=gulp;var p=function(){},v=new function(){var n=function(n){"function"==typeof n&&n(!1)};return n.wait=function(){var r=Array.prototype.slice.call(arguments);if(r.length>0&&"function"==typeof r[r.length-1]){var t=r[r.length-1];t(!1)}return n},n.notify=function(r,t){return null!=t&&t(!1),n},n}};module.exports=grunseq;